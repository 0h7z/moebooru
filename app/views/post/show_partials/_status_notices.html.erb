<% if @post.is_flagged? %>
  <div class="status-notice">
    This post was flagged for deletion by <%= h @post.flag_detail.author %>. Reason: <%= h @post.flag_detail.reason %>
    <% if @current_user.is_mod_or_higher? or (@post.flag_detail && @post.flag_detail.user_id == @current_user.id) then %>
    (<%= link_to_function "unflag this post", "Post.unflag(#{ @post.id }, function() { window.location.reload(); });" %>)
    <% end %>
    <% if @current_user.is_janitor_or_higher? %>
      (<%= link_to_function "delete", "Post.prompt_to_delete(#{@post.id});" %></li>)
    <% end %>
  </div>
<% elsif @post.is_pending? %>
  <div class="status-notice" id="pending-notice">
    This post is pending moderator approval.
    <% if @post.flag_detail %>
      Reason: <%= h @post.flag_detail.reason %>
    <% end %>
    <% if @current_user.is_janitor_or_higher? %>
      (<%= link_to_function "approve", "if (confirm('Do you really want to approve this post?')) {Post.approve(#{@post.id})}" %></li>)
      (<%= link_to_function "delete", "Post.prompt_to_delete(#{@post.id});" %></li>)
    <% end %>
  </div>
<% elsif @post.is_deleted? %>
  <div class="status-notice">
    This post was deleted. 
    <% if @post.flag_detail %>
      <% if @current_user.is_mod_or_higher? %>
        By: <%= link_to h(@post.flag_detail.author), :controller => "user", :action => "show", :id => @post.flag_detail.user_id %>
      <% end %>

      Reason: <%= h @post.flag_detail.reason %>. MD5: <%= @post.md5 %>
    <% end %>
  </div>
<% end %>

<% if @post.is_held %>
  <div class="status-notice" id="held-notice">
    This post has been temporarily held from the index by the poster.
    <% if @current_user.has_permission?(@post) %>
      (<%= link_to_function "activate this post", "Post.activate_post(#{ @post.id });" %>)
    <% end %>
  </div>
<% end %>

<% if !@post.is_deleted? && @post.use_sample?(@current_user) && @post.can_be_seen_by?(@current_user)%>
  <div class="status-notice" style="display: none;" id="resized_notice">
    This image has been resized. Click on the <%= link_to_function "View larger version", "Post.highres()" %> link in the sidebar for a high-quality version.
    <!--
    <% unless @current_user.is_anonymous? || CONFIG["force_image_samples"] %>
      <%= link_to_function "Always view original", :onclick => "User.disable_samples()" %>.
    <% end %>
    -->
    <%= link_to_function "Hide this message", "$('resized_notice').hide(); Cookie.put('hide_resized_notice', '1')" %>.
    <script type="text/javascript">
      if (Cookie.get("hide_resized_notice") != "1") {
        $("resized_notice").show()
      }
    </script>
  </div>
  <div class="status-notice" style="display: none;" id="samples_disabled">
    Image samples have been disabled. If you find this to be too slow, you can turn samples back on in your profile settings.
  </div>
<% end %>

<% if CONFIG["enable_parent_posts"] %>
  <% if @post.parent_id %>
    <div class="status-notice">
      This post belongs to a <%= link_to "parent post", :action => "show", :id => @post.parent_id %><%
      %><span class="advanced-editing"> (<%= link_to_function "make this post the parent", "Post.reparent_post(#{@post.id}, #{@post.parent_id}, #{@post.get_parent.parent_id ? "true":"false"})" %>)</span>.
    </div>
  <% end %>

  <% if @post.has_children? %>
    <% children = @post.children %>
    <div class="status-notice">
      This post has <%= link_to (children.length == 1? "a child post":"child posts"), :action => "index", :tags => "parent:#{@post.id}" %> (post #<%=
        children.map {|child| link_to(h(child.id), :action => "show", :id => child.id)}.join(", ") %>).
    </div>
  <% end %>
<% end %>

<% @pools.each do |pool| %>
  <%= render :partial => "post/show_partials/pool", :locals => {:pool => pool, :pool_post => PoolPost.find(:first, :conditions => ["pool_id = ? AND post_id = ?", pool.id, @post.id])} %>
<% end %>
